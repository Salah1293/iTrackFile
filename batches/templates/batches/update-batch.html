{% extends 'main.html' %} {% load static %} {% block content %}

<!-- Include jQuery library -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Main Section -->
<main class="singleBatch my-md">
  <div class="container">
    <div class="layout">
      <div
        class="column column--1of3"
        style="
          flex: 1;
          padding-left: 10px;
          max-height: 550px;
          overflow-y: scroll;
          border-radius: 0.7rem;
        "
      >
        <!-- Added max-height and overflow-y properties -->
        <div
          class="scrollable-images"
          style="border-radius: 0.7rem; border: 2px solid #070226"
        >
          <img
            class="scrollable-image"
            src="{% static 'images/1.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/2.jpg' %}"
            alt="image2"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/3.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/4.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/5.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/6.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/7.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/8.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/9.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/10.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/11.jpg' %}"
            alt="image2"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/12.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/13.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/14.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/15.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/16.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/17.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/18.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/19.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/20.jpg' %}"
            alt="image2"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/21.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/22.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/23.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/24.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/25.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/26.jpg' %}"
            alt="image1"
          />
          <img
            class="scrollable-image"
            src="{% static 'images/27.jpg' %}"
            alt="image1"
          />
        </div>
      </div>

      <div class="column column--1of3" style="flex: 6; padding: 0 10px">
        <div class="image-container">
          <div class="image-wrapper">
            <img
              id="selectedImage"
              class="singleBatch__preview"
              src="{% static 'images/1.jpg' %}"
              alt="batch title"
            />
          </div>
          <div class="image-controls" >
            <button id="zoomInBtn"><i class="fas fa-search-plus"></i></button>
            <button id="zoomOutBtn"><i class="fas fa-search-minus"></i></button>
            <button id="rotateBtn"><i class="fas fa-undo"></i></button>
            <button id="resetBtn"><i class="fas fa-undo"></i> Reset</button>
          </div>
        </div>
      </div>

      <div class="column column--1of3" style="flex: 1; padding-right: 10px">
        <!-- Added padding to the right -->
        <div class="content-box">
          <div class="formWrapper">
            <input
              class="btn btn--sub btn--md my-md"
              type="submit"
              value="Scan"
              style="background-color: rgb(194, 29, 29)"
            />
            <input
              class="btn btn--sub btn--md my-md"
              type="submit"
              value="Import"
              style="background-color: rgb(112, 222, 3)"
            />
            <form class="form" method="POST">
              <!-- Input:Text -->
              <div class="form__field">
                <label for="formInput#text">field 1</label>
                <input
                  class="input input--text"
                  id="formInput#text"
                  type="text"
                  name="text"
                  placeholder="Enter text"
                />
              </div>

              <!-- Input:Text -->
              <div class="form__field">
                <label for="formInput#text">field 2</label>
                <input
                  class="input input--text"
                  id="formInput#text"
                  type="text"
                  name="text"
                  placeholder="Enter text"
                />
              </div>

              <!-- Input:Text -->
              <div class="form__field">
                <label for="formInput#text">field 3</label>
                <input
                  class="input input--text"
                  id="formInput#text"
                  type="text"
                  name="text"
                  placeholder="Enter text"
                />
              </div>

              <!-- Input:Text -->
              <div class="form__field">
                <label for="formInput#text">field 4</label>
                <input
                  class="input input--text"
                  id="formInput#text"
                  type="text"
                  name="text"
                  placeholder="Enter text"
                />
              </div>
              <input
                class="btn btn--sub btn--md my-md"
                type="submit"
                value="Submit"
              />
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function () {
      // Add click event listener to each scrollable image
      $(".scrollable-image").on("click", function () {
        // Update the source of the selectedImage
        $("#selectedImage").attr("src", $(this).attr("src"));

        // Reset zoom, rotation, and position when a new image is selected
        resetTransform();
      });

      // Add zoom, rotate, and pan functionality to selectedImage
      let zoomLevel = 1;
      let rotationAngle = 0;
      let isDragging = false;
      let positionX = 0;
      let positionY = 0;
      let startX = 0;
      let startY = 0;

      $("#selectedImage")
        .on("wheel", function (event) {
          event.preventDefault();
          const delta = event.originalEvent.deltaY;

          // Zoom in
          if (delta < 0 && zoomLevel < 2) {
            zoomLevel += 0.1;
          }

          // Zoom out
          if (delta > 0 && zoomLevel > 0.5) {
            zoomLevel -= 0.1;
          }

          // Apply zoom
          updateTransform();
        })
        .on("mousedown", function (event) {
          isDragging = true;
          startX = event.clientX - positionX;
          startY = event.clientY - positionY;
        })
        .on("mouseup", function () {
          isDragging = false;
        })
        .on("mousemove", function (event) {
          if (isDragging) {
            positionX = event.clientX - startX;
            positionY = event.clientY - startY;
            updateTransform();
          }
        });

      $("#selectedImage").on("click", function (event) {
        // Calculate the position relative to the image
        const rect = this.getBoundingClientRect();
        const mouseX = event.clientX - rect.left;
        const mouseY = event.clientY - rect.top;

        // Adjust the position based on the click
        positionX -= mouseX * (zoomLevel - 1);
        positionY -= mouseY * (zoomLevel - 1);

        // Apply the updated position
        updateTransform();
      });

      $("#zoomInBtn").on("click", function () {
        if (zoomLevel < 2) {
          zoomLevel += 0.1;
          updateTransform();
        }
      });

      $("#zoomOutBtn").on("click", function () {
        if (zoomLevel > 0.5) {
          zoomLevel -= 0.1;
          updateTransform();
        }
      });

      $("#rotateBtn").on("click", function () {
        rotationAngle += 90;
        updateTransform();
      });

      $("#resetBtn").on("click", function () {
        resetTransform();
      });

      function updateTransform() {
        $("#selectedImage").css(
          "transform",
          `scale(${zoomLevel}) rotate(${rotationAngle}deg) translate(${positionX}px, ${positionY}px)`
        );
      }

      function resetTransform() {
        zoomLevel = 1;
        rotationAngle = 0;
        positionX = 0;
        positionY = 0;
        updateTransform();
      }
    });
  </script>
</main>

{% endblock content %}
